<html>
<head>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="dist/css/bootstrap.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
</head>
<body>
<?php
require_once "../controller/session.php";
require_once "common/header.phtml";
require_once "../model/Category.php";
?>
<div id="sell-form-content">
    <table align="center">
        <tr>
            <td>Ürün Adı:</td>
            <td><input type="text" name="product_name"></td>
        </tr>
        <tr>
            <td>Ürün Fiyatı:</td>
            <td><input type="text" name="price"></td>
        </tr>
        <tr>
            <td>Ürün Kategorisi:</td>
            <td><select id="firstCategory">
                    <option value="">Kategori Seçiniz..</option>
                    <?php $menus = Category::getCategoryByParentId(0);
                    while ($menu = mysqli_fetch_array($menus)) {
                        echo "<option value='" . $menu["id"] . "'>" . $menu["name"] . "</option>";
                    }
                    ?>
                </select>
            </td>
        </tr>
        <tr>
            <td></td>
            <td><select id="secondCategory"></select></td>
        </tr>
        <tr>
            <td></td>
            <td><select id="thirdCategory"></select></td>
        </tr>
    </table>
    <script type="text/javascript">
        $('#firstCategory').change(function () {
            var selectedFirst = $('#firstCategory').val();
            $.post("<?php require_once "../model/Constants.php";
                    echo Constants::$serverUrl; ?>/controller/getCategoryByJSON.php",
                {
                    id: selectedFirst
                },
                function (data) {
                    var json = jQuery.parseJSON(data);
                    var i = 0;
                    var htmlOptions = "";
                    while (i < json.length) {
                        htmlOptions += "<option value='" + json[i].id + "'>" + json[i].name + "</option>";
                        i++;
                    }
                    $('#secondCategory').html(htmlOptions);
                });
        });
        $('#secondCategory').change(function () {
            var selectedSecond = $('#secondCategory').val();
            $.post("<?php require_once "../model/Constants.php";
                    echo Constants::$serverUrl; ?>/controller/getCategoryByJSON.php",
                {
                    id: selectedSecond
                },
                function (data) {
                    var json = jQuery.parseJSON(data);
                    var i = 0;
                    var htmlOptions = "";
                    while (i < json.length) {
                        htmlOptions += "<option value='" + json[i].id + "'>" + json[i].name + "</option>";
                        i++;
                    }
                    $('#thirdCategory').html(htmlOptions);
                });
        });
    </script>
</div>
</body>
</html>